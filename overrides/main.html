{% extends "base.html" %}

{% block content %}
{% if page.nb_url %}
    {# Take the second-to-last segment: tutorial_name from page.nb_url #}
    {% set tutorial_name = page.nb_url.split('/')[-2] %}
    {% set tutorial_file = tutorial_name ~ ".ipynb" %}

    {# Google Colab link to the notebook in the repo #}
    {% set colab_href =
        "https://colab.research.google.com/github/easyscience/diffraction-lib/blob/gh_pages/tutorials/" ~
        tutorial_name ~ "/" ~ tutorial_file %}
    <a href="{{ colab_href }}" title="Open in Google Colab" class="md-content__button md-icon">
        {% include ".icons/google-colab.svg" %}
    </a>

    {# Direct download from gh_pages (raw) #}
    {# href="{{ page.nb_url }}" doesn't work for easyscience.github.io as it generates
       /lib/tutorials/TUTORIAL_NAME/TUTORIAL_NAME.ipynb
       instead of
       /diffraction-lib/tutorials/TUTORIAL_NAME/TUTORIAL_NAME.ipynb.
       This is because nb_url uses site_url: https://docs.easydiffraction.org/lib/ from
       mkdocs.yml and strips out the domain.
       So, we get /lib (needed for https://docs.easydiffraction.org), instead of /diffraction-lib
       (needed for https://easyscience.github.io).
       For the main website https://docs.easydiffraction.org, everything works as expected.
       In the following, we also add download="{{ tutorial_name }}.ipynb" to
       enable downloading by clicking the download button instead of opening
       the raw content of the notebook in the browser.
       #}
    {% set download_href = page.nb_url %}
    <a href="{{ download_href }}" download="{{ tutorial_file }}" title="Download Notebook" class="md-content__button md-icon">
        {% include ".icons/material/download.svg" %}
    </a>
{% endif %}

{{ super() }}
{% endblock content %}
